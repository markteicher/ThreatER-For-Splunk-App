# default/props.conf
# ThreatER for Splunk App
#
# Design goals:
# - Safe JSON ingestion
# - Explicit time handling
# - No automatic mutation
# - Compatible with transforms.conf
# - AppInspect compliant
###############################################################################

###############################################################################
# GLOBAL ThreatER SOURCETYPES
###############################################################################

[threater:*]

############################
# LINE HANDLING
############################
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0

############################
# JSON HANDLING
############################
KV_MODE = json
AUTO_KV_JSON = true
INDEXED_EXTRACTIONS = none

############################
# TIMESTAMP HANDLING
############################
DATETIME_CONFIG = CURRENT

# Accept multiple timestamp candidates
TIMESTAMP_FIELDS = timestamp,created_at,updated_at,last_updated,generated_at,event_time

# ISO-8601 default (UTC-safe)
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32

############################
# SEARCH-TIME SAFETY
############################
NO_BINARY_CHECK = true
CHARSET = UTF-8

###############################################################################
# INGESTION HEALTH (EXPLICIT, ISOLATED)
###############################################################################

[threater:ingestion_health]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

# Health events should always timestamp at index time
DATETIME_CONFIG = CURRENT

###############################################################################
# HIGH-VOLUME EVENT TYPES (OPTIMIZED)
###############################################################################

[threater:block_event]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

[threater:unexpected_block]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

[threater:ioc_result]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

###############################################################################
# ADMIN / AUDIT LOGS
###############################################################################

[threater:command_log]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

[threater:user_activity]
SHOULD_LINEMERGE = false
KV_MODE = json
AUTO_KV_JSON = true

###############################################################################
# OPTIONAL TRANSFORM HOOKS (DISABLED BY DEFAULT)
# Uncomment intentionally â€” never auto-applied
###############################################################################

#[threater:block_event]
#TRANSFORMS-set-host = threater_set_host_from_enforcer
#TRANSFORMS-route-events = threater_route_events

#[threater:command_log]
#TRANSFORMS-route-admin = threater_route_admin

###############################################################################
# END OF FILE
###############################################################################
