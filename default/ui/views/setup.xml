<form version="1.1">
  <label>Setup</label>

  <description>
    Configure ThreatER API access, proxy settings, and data collection options.
    These settings are required before enabling modular inputs.
  </description>

  <!-- ========================= -->
  <!-- API Configuration -->
  <!-- ========================= -->
  <fieldset submitButton="true">
    <legend>ThreatER API Configuration</legend>

    <input type="text" token="api_base_url" required="true">
      <label>API Base URL</label>
      <default>https://portal.threater.com/api/v3</default>
    </input>

    <input type="password" token="api_key" required="true">
      <label>API Key</label>
    </input>

    <input type="text" token="request_timeout">
      <label>Request Timeout (seconds)</label>
      <default>30</default>
    </input>

    <input type="checkbox" token="verify_ssl">
      <label>Verify SSL Certificates</label>
      <choice value="true">Enable SSL Verification</choice>
      <default>true</default>
    </input>

    <input type="checkbox" token="enable_api_v6">
      <label>Enable API v6 (Experimental)</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

  </fieldset>

  <!-- ========================= -->
  <!-- Proxy Configuration -->
  <!-- ========================= -->
  <fieldset submitButton="false">
    <legend>Proxy Configuration (Optional)</legend>

    <input type="checkbox" token="proxy_enabled">
      <label>Enable Proxy</label>
      <choice value="true">Use Proxy</choice>
      <default>false</default>
    </input>

    <input type="text" token="proxy_url" depends="$proxy_enabled$">
      <label>Proxy URL</label>
    </input>

    <input type="text" token="proxy_username" depends="$proxy_enabled$">
      <label>Proxy Username</label>
    </input>

    <input type="password" token="proxy_password" depends="$proxy_enabled$">
      <label>Proxy Password</label>
    </input>

  </fieldset>

  <!-- ========================= -->
  <!-- Data Collection -->
  <!-- ========================= -->
  <fieldset submitButton="false">
    <legend>Data Collection</legend>

    <input type="checkbox" token="collect_lists">
      <label>Lists (Allow, Block, Threat)</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_plugins">
      <label>Plugins / External Lists</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_enforcers">
      <label>Enforcers &amp; Enforcement Status</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_networks">
      <label>Networks &amp; Ports</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_users">
      <label>Users &amp; Administration</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_reports">
      <label>Reports &amp; Scheduled Reports</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

    <input type="checkbox" token="collect_events">
      <label>Block Events &amp; Subscriptions</label>
      <choice value="true">Enable</choice>
      <default>false</default>
    </input>

  </fieldset>

</form>
