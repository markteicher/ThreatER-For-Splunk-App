<!-- default/data/ui/views/setup.xml -->
<!-- ThreatER for Splunk App -->
<!-- Setup & Configuration -->

<form version="1.1">
  <label>Setup</label>

  <description>
    Configure ThreatER API access, proxy settings, and data ingestion
    for the ThreatER preemptive threat filtering platform.
  </description>

  <!-- ========================= -->
  <!-- Configuration Inputs -->
  <!-- ========================= -->
  <fieldset submitButton="true">

    <!-- API Configuration -->
    <input type="text" token="api_base_url" required="true">
      <label>ThreatER API Base URL</label>
      <default>https://portal.threater.com/api/v3</default>
    </input>

    <input type="password" token="api_key" required="true">
      <label>ThreatER API Key</label>
    </input>

    <input type="text" token="request_timeout">
      <label>Request Timeout (seconds)</label>
      <default>30</default>
    </input>

    <!-- Index Configuration -->
    <input type="text" token="target_index">
      <label>Target Index</label>
      <default>security_threater</default>
    </input>

    <!-- Proxy Configuration -->
    <input type="checkbox" token="use_proxy">
      <label>Proxy Configuration</label>
      <choice value="true">Enable Proxy</choice>
    </input>

    <input type="text" token="proxy_url" depends="$use_proxy$">
      <label>Proxy URL</label>
    </input>

    <input type="text" token="proxy_username" depends="$use_proxy$">
      <label>Proxy Username</label>
    </input>

    <input type="password" token="proxy_password" depends="$use_proxy$">
      <label>Proxy Password</label>
    </input>

  </fieldset>

  <!-- ========================= -->
  <!-- Submit Handler -->
  <!-- ========================= -->
  <row>
    <panel>
      <html>
        <p>
          Click <strong>Submit</strong> to save configuration and enable
          ThreatER data collection.
        </p>
      </html>
    </panel>
  </row>

</form>
