<form version="1.1">
  <label>Appliances</label>

  <description>
    Inventory of ThreatER appliances and their operational status.
  </description>

  <!-- ========================= -->
  <!-- BASE SEARCH -->
  <!-- ========================= -->
  <search>
    <query>
      index=security_threater sourcetype=threater:appliance
    </query>
  </search>

  <!-- ========================= -->
  <!-- FILTERS -->
  <!-- ========================= -->
  <fieldset submitButton="false">

    <input type="text" token="name_filter">
      <label>Appliance Name</label>
    </input>

    <input type="dropdown" token="status_filter">
      <label>Status</label>
      <choice value="*">All</choice>
      <choice value="active">Active</choice>
      <choice value="inactive">Inactive</choice>
      <choice value="error">Error</choice>
      <default>*</default>
    </input>

    <input type="dropdown" token="network_status_filter">
      <label>Network Status</label>
      <choice value="*">All</choice>
      <choice value="UP">UP</choice>
      <choice value="DOWN">DOWN</choice>
      <default>*</default>
    </input>

    <input type="dropdown" token="uptodate_filter">
      <label>Software State</label>
      <choice value="*">All</choice>
      <choice value="true">Up To Date</choice>
      <choice value="false">Out of Date</choice>
      <default>*</default>
    </input>

  </fieldset>

  <!-- ========================= -->
  <!-- APPLIANCE TABLE -->
  <!-- ========================= -->
  <row>
    <panel>
      <table>
        <title>Appliance Inventory</title>

        <search>
          <query>
            index=security_threater sourcetype=threater:appliance
            | search
                name="*$name_filter$*"
                status="$status_filter$"
                networkStatus="$network_status_filter$"
                isUpToDate="$uptodate_filter$"
            | table
                name
                uuid
                serialNumber
                status
                networkStatus
                chassis
                softwareVersion
                updateStatus
                isUpToDate
                throughputPercent
                lastConnectedDatetime
                supportEndsDatetime
                company_name
                msp_name
          </query>
        </search>

        <option name="count">20</option>
        <option name="wrap">false</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

</form>
