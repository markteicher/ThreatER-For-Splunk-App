<dashboard version="1.1">
  <label>Appliance Status Details</label>

  <row>
    <panel>
      <table>
        <title>Appliance Status</title>
        <search>
          <query>
index=security_threater sourcetype=threater:appliance_status uuid="$appliance_uuid$"
| eval
    last_connected_epoch = strptime(lastConnectedDatetime, "%Y-%m-%dT%H:%M:%S.%3N%z"),
    now_epoch = now(),
    diff_seconds = now_epoch - last_connected_epoch
| eval
    connection_age =
        case(
            diff_seconds &gt;= 31536000, floor(diff_seconds/31536000) . " years",
            diff_seconds &gt;= 2592000,  floor(diff_seconds/2592000)  . " months",
            diff_seconds &gt;= 604800,   floor(diff_seconds/604800)   . " weeks",
            diff_seconds &gt;= 86400,    floor(diff_seconds/86400)    . " days",
            diff_seconds &gt;= 3600,     floor(diff_seconds/3600)     . " hours",
            true(),                     diff_seconds . " seconds"
        )
| table
    uuid
    status
    networkStatus
    updateStatus
    isUpToDate
    throughputPercent
    lastConnectedDatetime
    connection_age
          </query>
        </search>
        <option name="wrap">false</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

</dashboard>
