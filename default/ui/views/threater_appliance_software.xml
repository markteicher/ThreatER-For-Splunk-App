<form version="1.1">
  <label>Appliance Software</label>

  <description>
    Software and firmware details for a specific ThreatER appliance.
  </description>

  <!-- ========================= -->
  <!-- APPLIANCE UUID -->
  <!-- ========================= -->
  <fieldset submitButton="false">
    <input type="text" token="appliance_uuid" required="true">
      <label>Appliance UUID</label>
    </input>
  </fieldset>

  <!-- ========================= -->
  <!-- BASE SEARCH -->
  <!-- ========================= -->
  <search>
    <query>
      index=security_threater sourcetype=threater:appliance_software uuid="$appliance_uuid$"
    </query>
  </search>

  <!-- ========================= -->
  <!-- SOFTWARE SUMMARY -->
  <!-- ========================= -->
  <row>
    <panel>
      <table>
        <title>Installed Software</title>
        <search>
          <query>
            index=security_threater sourcetype=threater:appliance_software uuid="$appliance_uuid$"
            | table
                uuid
                family
                version
                buildNumber
                status
                priority
                releaseDatetime
                hasReleaseNotes
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

  <!-- ========================= -->
  <!-- ARCHITECTURE DETAILS -->
  <!-- ========================= -->
  <row>
    <panel>
      <table>
        <title>Supported Architectures</title>
        <search>
          <query>
            index=security_threater sourcetype=threater:appliance_software uuid="$appliance_uuid$"
            | table
                architecture
                md5sum
                supportsWifi
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="drilldown">none</option>
      </table>
    </panel>
  </row>

</form>
