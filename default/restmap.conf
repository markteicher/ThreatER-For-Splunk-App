# default/restmap.conf
# ThreatER for Splunk App
#
# REST endpoint mappings for setup, validation, and input control
# AppInspect compliant
###############################################################################

###############################################################################
# SETUP & CONFIGURATION (ADMIN ONLY)
###############################################################################

[script:defender_threater_setup]
match = /threater/setup
script = defender_threater_setup_handler.py
scripttype = python
python.version = python3
handleractions = list,edit
requiredCapabilities = threater_admin

[script:defender_threater_setup_reload]
match = /threater/setup/reload
script = defender_threater_setup_handler.py
scripttype = python
python.version = python3
handleractions = reload
requiredCapabilities = threater_admin

###############################################################################
# VALIDATION & CONNECTIVITY (READ OK)
###############################################################################

[script:defender_threater_validate]
match = /threater/validate
script = defender_threater_validation.py
scripttype = python
python.version = python3
handleractions = list
requiredCapabilities = threater_read

###############################################################################
# MODULAR INPUT MANAGEMENT (ADMIN ONLY)
###############################################################################

[script:defender_threater_inputs]
match = /threater/inputs
script = defender_threater_input_handler.py
scripttype = python
python.version = python3
handleractions = list
requiredCapabilities = threater_admin

[script:defender_threater_inputs_status]
match = /threater/inputs/status
script = defender_threater_input_handler.py
scripttype = python
python.version = python3
handleractions = edit
requiredCapabilities = threater_admin

[script:defender_threater_inputs_enable]
match = /threater/inputs/enable
script = defender_threater_input_handler.py
scripttype = python
python.version = python3
handleractions = edit
requiredCapabilities = threater_admin

[script:defender_threater_inputs_disable]
match = /threater/inputs/disable
script = defender_threater_input_handler.py
scripttype = python
python.version = python3
handleractions = edit
requiredCapabilities = threater_admin

###############################################################################
# HEALTH & DIAGNOSTICS (READ OK)
###############################################################################

[script:defender_threater_health]
match = /threater/health
script = defender_threater_validation.py
scripttype = python
python.version = python3
handleractions = list
requiredCapabilities = threater_read

###############################################################################
# FUTURE BACKFILL / REPLAY (ADMIN ONLY â€“ SAFE PLACEHOLDER)
###############################################################################

[script:defender_threater_backfill]
match = /threater/backfill
script = defender_threater_input_handler.py
scripttype = python
python.version = python3
handleractions = edit
requiredCapabilities = threater_admin
